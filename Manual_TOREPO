Manual TOREPO

1. Introduction
TOREPO is divided into three programs (Topology, Replicate Polymer and Polyanagro). This manual provides an overview of TOREPO and a detailed guide about how to use these programs, as well as configurate the remote server for execute these programs. In addition, TOREPO allows users to visualize moleculars and polymers structures using the stmol tool (Nápoles-Duarte et al, 2022).

In TOREPO, we use Streamlit to provide a user-friendly and efficient interface that allows researches to modifiy the molecular topology of polymers and replicate polymeric structures interactively. Streamlit is an open-source library that enables researches to create web applications with few lines of Python code and without the need for front-end coding skills. It has been widely used to develop scientific web applications that facilitate the exploration of large data sets and the acquisition of new sctientific insights (Parker et al, 2022; Kui et al, 2022; Absar et al, 2022; Li et al, 2022a; Li et al, 2022b).

The Streamlit capability to integrate interactive 3D visualization, using components such as 'Stmol', enhances the user experience by allowing clear and manipulable visualization of molecular structures (Nápoles-Duarte et al, 2022), This integration facilitates the understanding and analysis of complex data, making the research process more accesible and collaborative.


2. Methods
    2.1 Manuals
        2.1.1 Server options
        When opening the TOREPO interface and selecting the desired program, server configuration will appear in the sidebar.

            2.1.1.1 Loading server options
            In the "Load file:" field, select the path to the .json file that contains the server options. Once the file is selected, the program will load and display the server options.

            2.1.1.2 Configuring server options
            In the "Server options" section, fill in the following fields:

                - Name Server: Enter the name of the remote server, which can be an IP address.

                - Username: Enter the username.

                - Key SSH file path: Enter the path to the SSH key file to be used for autentication.

                - Virtual environment path: Enter the path to the virtual environment located on the remote server. All three TOREPO programs can be located in the same virtual environment.
                
                - Working directory: Enter the path to the working directory within the remote server. This directory is where the files generated by the program will be saved.
            
            2.1.1.3 Saving server options
            In the "Filename" field, enter a name for the file in .json format. After entering the name and ensuring all fields in "Server options" section are completed, a "Save" button will appear to save the server options to a .json file.

            2.1.1.4 Sistema de colas (IGNORAR)
            Seleccionar entre 'sbatch' o 'squeue' según el sistema de colas utilizado en el servidor remoto.
            Script antes de la ejecución:

            Introducir cualquier script o comando que deba ejecutarse antes del inicio del trabajo.
            Script después de la ejecución:

            Introducir cualquier script o comando que deba ejecutarse después de que el trabajo haya finalizado.

            2.1.1.5 Checking server options
            During the server configuration, TOREPO will automatically check that the provided path, names and files are valid. In case there are no errors, it means the settings are correct and the program is ready to be executed.

        2.1.2 Topology
        Topology program is an open-source Python library designed for the rapid modification of polymer molecular topology. It specifies atoms, bonds, and angles. The tool also converts polymer structures into readable formats such as .pdb, .gro and .psf, providing detailed information about the polymer chains, including atom types, monomers, backbone and branch atoms, etc.

            2.1.2.1 Info
            The interface begins with a welcoming screen displayng the title "Topology" and a simple description of the program within the "INFO" section.

            2.1.2.2 Program options
            This section includes several fields that the user must complete to run the program. Mandatory fields are marked with an asterisk (*).

                2.1.2.2.1 Input file selection
                Users must upload files required for the program. These include:
                    
                    - An input file (.xsd, .pdb or .MOL2 format)

                    - Optional files for renumbing PDB (.dat format), assigning residues (.dat format) and matching LAMMPS types (.dat format).

                2.1.2.2.2 Pattern
                Users must provide a string pattern to name the new files generated by the program. 

                2.1.2.2.3 Additional options
                Users can select others options such as creating a separate .pdb file for each chain, unwrapping coordinates in the final structure, or guessing impropers angles in the system.
            
            2.1.2.3 Running program
            Upon running Topology, the program will previously check that all files and options are correctly provided. If all validations pass, the program will exceute and generate the output files.

            2.1.2.4 Output files
            Upon completion Topology execution, the program displays the output files and provides a download link for users to get the files generated.

        2.1.3 Replicate Polymer
        Replicate Polymer program is an open-sourcce Python library that quickly replicates a molecule from a .pdb file containing the seed molecule. It assigns force field parameters using the Foyer library (https://mosdef.org/ (REFERENCIA)) and generates GROMACS and LAMMPPS files for simulations. The program produces three output files in .gro, .top and .pdb format. The tool also simulates polymer systems periodically, avoiding edge effects and enhancing system representation. This program is essential for simulating polymers under periodic boundary conditions (PBC), reducing discrepancies in interactions between atoms at the edges and those within the interior.

            2.1.3.1 Info
            As in the previous program, the interface begins with a welcoming screen, followed by the title "Replicate Polymer" and a simple description of the program within the "INFO" section.

            2.1.3.2 Program options
            Users must also complete the mandatory fields marked with an asterisk (*) to execute the program.

                2.1.3.2.1 Input file selection
                Users must upload the following files:

                    - .pdb file: Contains the molecular structure to be replicated.
                    - Force Field file (.xml format): Provides the force field parameters necessary for simulations.

                    - Improper file (.ndx format): This input file is optional when it is necessary to add an improper file.

                2.1.3.2.2 Replication dimensions
                In this section, the number of images are specified to replicate in each dimension (X, Y, and Z).

                2.1.3.2.3 Additional parameters (optional)

                    - Atom indexes: Provide indices of atoms to be removed from the .pdb file.

                    - Box dimensions and angles: Set the dimensions (a, b, c) and angles (alpa, beta, gamma) for the simulation box.

                    - Monomer or residue inclusions: Enter the number of pairs to be included in the calculations.

                    - MD engine: The molecular dynamics package is specified for the calculations.

                    - Remove hydrogens: Select wether to remove hydrogens for a united atom representation.

                    - Verbose mode: Select verbose checking of angles and dihedrals in case of there is angles without assignment.

            2.1.3.3 Running program
            Upon running Replicate Polymer, the program checks that all required fields are filled and that the provided values are valid. Later, the program will execute and generate the output files if all entered options are valid.

            2.1.3.4 Output files
            Upon successful execution, the program generates and displays the output files. Users can also download the output files thorugh a provided link.

        2.1.4 Polyanagro

            2.1.4.1 2D Torsion Density Maps
            



            *****copied text below*****

            Topology program is an open-source Python library designed for the rapid modification of polymer molecular topology. It specifies atoms, bonds, and angles. The tool also converts polymer structures into readable formats such as .pdb, .gro and .psf, providing detailed information about the polymer chains, including atom types, monomers, backbone and branch atoms, etc





            2.1.2.1 Info
            The interface begins with a welcoming screen displayng the title "Topology" and a simple description of the program within the "INFO" section.

            2.1.2.2 Program options
            This section includes several fields that the user must complete to run the program. Mandatory fields are marked with an asterisk (*).

                2.1.2.2.1 Input file selection
                Users must upload files required for the program. These include:
                    - An input file (.xsd, .pdb or .MOL2 format)
                    - Optional files for renumbing PDB (.dat format), assigning residues (.dat format) and matching LAMMPS types (.dat format).

                2.1.2.2.2 Pattern
                Users must provide a string pattern to name the new files generated by the program. 

                2.1.2.2.3 Additional options
                Users can select others options such as creating a separate .pdb file for each chain, unwrapping coordinates in the final structure, or guessing impropers angles in the system.
            
            2.1.2.3 Running program
            Upon running Topology, the program will previously check that all files and options are correctly provided. If all validations pass, the program will exceute and generate the output files.

            2.1.2.4 Output files
            Upon completion Topology execution, the program displays the output files and provides a download link for users to get the files generated.

            *****copied text up*****





            2.1.4.2 Bonded Distribution
            2.1.4.3 Energy Analysis
            2.1.4.4 Info TRJ
            2.1.4.5 Neighbor Sphere
            2.1.4.6 Pair Distribution
            2.1.4.7 Polymer Size
            2.1.4.8 VOTCA Analysis

        2.1.5 Stmol viewer
            2.1.5.1 Info
            'stmol' is a tool designed to integrate interactive molecular visualizations within Streamlit web applicartions. It enables researches to visualize and render 3D molecular structures in an intuitive and user-friendly way (Nápoles-Duarte et al, 2022).

            2.1.5.2 Viewer options
            In order to enable the viewer and access its options, users must first activate the "Display stmol viewer" toggle located in the sidebar. Once activated, the viewer optoins become available, allowing users to customize various aspects of the molecular visualization. These options include:
                2.1.5.2.1 Structure style
                Users can choose from multiple styles, including cartoon (NOT OK), line, cross, stick, and sphere, to represent the molecular structure.

                2.1.5.2.2 Residue name
                Users can specify residue names to highlight specific residues in the molecular structure.

                2.1.5.2.3 Chain number
                Users can select chain numbers to display particular chains within the structure.

                2.1.5.2.4 Atom number
                Users can find specific atoms by selecting their numbers.

                2.1.5.2.5 Color customization
                    - Residues selected color
                    - Chains selected color
                    - Atoms selected color
                    - Backbone color (NOT FUNCIONAL)
                    - Viewer background color

                2.1.5.2.6 Surface transparency
                Users can adjust the transparency of the molecular surface from 0.0 to 1.0 through a slider.

                2.1.5.2.7 Simulation box
                If the uploaded .pdb file includes box dimensions, users can choose to display a simulation box around the structure and customize its color.
            
            2.1.5.3 Viewer output
            Upon uplading the .pdb file, the 3D viewer is automatically displayed. Users can then configure the visualization options according to their preferences. The 'py3Dmol' library  (REFERENCE) is used to render the @molecular structure with the selected visualization options. The user can interact with the 3D model, zoom in/out, and rotate it for a detailed view.
